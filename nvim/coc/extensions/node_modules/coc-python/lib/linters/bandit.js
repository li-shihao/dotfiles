// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
const coc_nvim_1 = require("coc.nvim");
const types_1 = require("../common/types");
const baseLinter_1 = require("./baseLinter");
const types_2 = require("./types");
const severityMapping = {
    LOW: types_2.LintMessageSeverity.Information,
    MEDIUM: types_2.LintMessageSeverity.Warning,
    HIGH: types_2.LintMessageSeverity.Error
};
class Bandit extends baseLinter_1.BaseLinter {
    constructor(outputChannel, serviceContainer) {
        super(types_1.Product.bandit, outputChannel, serviceContainer);
    }
    async runLinter(document, cancellation) {
        // View all errors in bandit <= 1.5.1 (https://github.com/PyCQA/bandit/issues/371)
        const messages = await this.run([
            '-f', 'custom', '--msg-template', '{line},0,{severity},{test_id}:{msg}', '-n', '-1', coc_nvim_1.Uri.parse(document.uri).fsPath
        ], document, cancellation);
        messages.forEach(msg => {
            msg.severity = severityMapping[msg.type];
        });
        return messages;
    }
}
exports.Bandit = Bandit;
//# sourceMappingURL=bandit.js.map